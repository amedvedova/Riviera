;+; NAME:;   AML_SON_gillfile.pro;; PURPOSE:;   liest die ascii-kalibrierfiles von gill R2 sonics in eine;   struktur ein.;; CALLING SEQUENCE:;   kalib=AML_SON_gillfile(serno, gilldir=gilldir);; INPUTS:;   serno     : integer. seriennummer des R2.;   gilldir   : directory in welchem sich die gill-kalibrierfiles befinden.;; OUTPUT:;   structure der form:;      UV              DOUBLE    Array[360, 2];      W               DOUBLE    Array[360, 2];   mit den werten der gill-kalibrierung.;; EXAMPLE:;   gill=AML_SON_gillfile(43,'\\gibm-ntserver3\messnetz\kalib\sonics\gill\') ;gill 0043;   plot, gill.w[*,1], /ynozero;; REVISION HISTORY:;   13.12.2001 AC nach RV (MAP);-function AML_SON_gillfile, serno, gilldir    skalfak=1.d/65536.0d ;faktor mit dem werte skaliert werden    serno=fix(serno)    gill=-1    strserno=string(serno,format='(i4.4)')    ;filenamen basteln    uv_finam = gilldir+strserno+'rcal.h'    w_fil    = gilldir+'wcal.h'    w_exist=findfile(w_fil)    uv_exist=findfile(uv_finam)    if w_exist[0] eq '' or uv_exist[0] eq '' then begin        message, 'gill files do not exist for this serial no :'+strserno+' (Missing: "'+uv_finam+'" and/or "'+w_fil+'")', /informational        return, -1    endif    gill_uv = dblarr(360,2) & gill_w = dblarr(360,2)    h = dblarr(361) ; dummy zum einlesen    zeile   = ''    openr,lun,uv_finam,/get_lun    readf,lun,zeile    getrennt=strsplit(zeile,'=',/extract)    if strpos(getrennt[0],'int an_serial_number') eq 0 and n_elements(getrennt) eq 2 then begin    if strcompress(getrennt[1], /remove_all) eq strcompress(string(serno),/remove_all)+';' then begin    readf,lun,zeile  ;zweite zeile    if strpos(zeile,'long magnitude_calibration_table[361]') eq 0 then begin     readf,lun,h      gill_uv[*,0]= h[0:359]*skalfak     readf,lun,zeile & readf,lun,zeile ;weitere zeilen     readf,lun,h      gill_uv[*,1]=h[0:359]*skalfak    endif else goto, error     close, lun     free_lun,lun     openr,lun,w_fil,/get_lun     readf,lun,zeile     if strpos(zeile,'long up_w_calibration_table[361] =') eq 0 then begin     readf,lun,h     gill_w[*,0]=h[0:359]*skalfak     readf,lun,zeile & readf,lun,zeile     readf,lun,h     gill_w[*,1]=h[0:359]*skalfak     close, lun     free_lun,lun     gill={uv : gill_uv, w : gill_w }     endif else begin        message, w_fil+' is not a w-cal format file.', /informational        return, -1     endelse    endif else goto, error    endif    return, gill    error: message, uv_finam+' is not a valid gill file or a gill file with a serial other than specified. no gill calibration can be applied', /informational    return, -1end